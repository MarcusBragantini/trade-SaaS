<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ForexAI Trading - Sistema Profissional de Trading Automatizado</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p>Carregando ForexAI Trading System...</p>
        </div>
    </div>

    <!-- Auth Modal -->
    <div id="auth-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="auth-modal-title">Entrar no ForexAI</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div id="login-form">
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" placeholder="seu@email.com" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Senha</label>
                        <input type="password" id="password" placeholder="Sua senha" required>
                    </div>
                    <button id="login-btn" class="btn btn-primary btn-full">Entrar</button>
                    <p class="auth-switch">Não tem uma conta? <a href="#" id="switch-to-register">Registrar</a></p>
                </div>

                <div id="register-form" style="display: none;">
                    <div class="form-group">
                        <label for="reg-name">Nome Completo</label>
                        <input type="text" id="reg-name" placeholder="Seu nome completo" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-email">Email</label>
                        <input type="email" id="reg-email" placeholder="seu@email.com" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-password">Senha</label>
                        <input type="password" id="reg-password" placeholder="Mínimo 6 caracteres" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-confirm-password">Confirmar Senha</label>
                        <input type="password" id="reg-confirm-password" placeholder="Digite novamente sua senha" required>
                    </div>
                    <button id="register-btn" class="btn btn-primary btn-full">Criar Conta</button>
                    <p class="auth-switch">Já tem uma conta? <a href="#" id="switch-to-login">Entrar</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboard" style="display: none;">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-chart-line"></i>
                    <span>ForexAI Trading</span>
                </div>
            </div>
            <div class="header-center">
                <div class="market-status">
                    <span class="status-indicator live"></span>
                    <span>Mercado Aberto</span>
                    <span class="market-time" id="market-time">09:30:15</span>
                </div>
            </div>
            <div class="header-right">
                <div class="user-menu">
                    <div class="user-info">
                        <span class="user-name" id="user-name">Carregando...</span>
                        <span class="user-plan" id="user-plan">Free</span>
                    </div>
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="dropdown-menu">
                        <a href="#" class="dropdown-item" id="profile-btn">
                            <i class="fas fa-user"></i> Perfil
                        </a>
                        <a href="#" class="dropdown-item" id="subscription-btn">
                            <i class="fas fa-crown"></i> Assinatura
                        </a>
                        <a href="#" class="dropdown-item" id="settings-btn">
                            <i class="fas fa-cog"></i> Configurações
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item" id="logout-btn">
                            <i class="fas fa-sign-out-alt"></i> Sair
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="dashboard-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <nav class="sidebar-nav">
                    <a href="#" class="nav-item active" data-section="overview">
                        <i class="fas fa-home"></i>
                        <span>Visão Geral</span>
                    </a>
                    <a href="#" class="nav-item" data-section="trading">
                        <i class="fas fa-chart-bar"></i>
                        <span>Trading</span>
                    </a>
                    <a href="#" class="nav-item" data-section="analysis">
                        <i class="fas fa-brain"></i>
                        <span>Análise IA</span>
                    </a>
                    <a href="#" class="nav-item" data-section="history">
                        <i class="fas fa-history"></i>
                        <span>Histórico</span>
                    </a>
                    <a href="#" class="nav-item" data-section="subscription">
                        <i class="fas fa-crown"></i>
                        <span>Assinatura</span>
                    </a>
                    <a href="#" class="nav-item" data-section="settings">
                        <i class="fas fa-cog"></i>
                        <span>Configurações</span>
                    </a>
                </nav>
                
                <div class="sidebar-footer">
                    <div class="system-status">
                        <div class="status-item">
                            <span class="status-label">API Deriv</span>
                            <span class="status-value connected" id="deriv-status">Conectado</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">IA</span>
                            <span class="status-value connected" id="ai-status">Ativa</span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Content Area -->
            <main class="main-content">
                <!-- Overview Section -->
                <section id="overview-section" class="content-section active">
                    <div class="section-header">
                        <h1>Visão Geral da Conta</h1>
                        <div class="header-actions">
                            <button class="btn btn-secondary" id="refresh-data">
                                <i class="fas fa-sync-alt"></i> Atualizar
                            </button>
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="stat-info">
                                <h3>Saldo Disponível</h3>
                                <span class="stat-value" id="balance-value">$0.00</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon profit">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-info">
                                <h3>Lucro Hoje</h3>
                                <span class="stat-value" id="daily-profit">$0.00</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-exchange-alt"></i>
                            </div>
                            <div class="stat-info">
                                <h3>Posições Abertas</h3>
                                <span class="stat-value" id="open-positions">0</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <div class="stat-info">
                                <h3>Taxa de Acerto</h3>
                                <span class="stat-value" id="win-rate">0%</span>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid">
                        <div class="content-card">
                            <h3>Status da Assinatura</h3>
                            <div class="subscription-status" id="subscription-status">
                                <div class="status-indicator inactive"></div>
                                <span>Assinatura Inativa</span>
                            </div>
                            <p>Ative sua assinatura para desbloquear todos os recursos de trading automatizado.</p>
                            <button class="btn btn-primary" id="upgrade-subscription">Ativar Assinatura</button>
                        </div>

                        <div class="content-card">
                            <h3>Configuração da API Deriv</h3>
                            <div class="api-status" id="api-status">
                                <div class="status-indicator disconnected"></div>
                                <span>API Não Configurada</span>
                            </div>
                            <p>Configure suas credenciais da API Deriv para começar a operar.</p>
                            <button class="btn btn-secondary" id="configure-api">Configurar API</button>
                        </div>
                    </div>

                    <div class="content-card">
                        <h3>Últimas Transações</h3>
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Ativo</th>
                                        <th>Direção</th>
                                        <th>Valor</th>
                                        <th>Resultado</th>
                                        <th>Data/Hora</th>
                                    </tr>
                                </thead>
                                <tbody id="recent-transactions">
                                    <tr>
                                        <td colspan="5" class="text-center">Nenhuma transação recente</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Trading Section -->
                <section id="trading-section" class="content-section">
                    <div class="section-header">
                        <h1>Plataforma de Trading</h1>
                        <div class="header-actions">
                            <div class="trading-controls">
                                <label class="switch">
                                    <input type="checkbox" id="auto-trading-toggle">
                                    <span class="slider round"></span>
                                </label>
                                <span>Trading Automático</span>
                            </div>
                        </div>
                    </div>

                    <div class="trading-layout">
                        <div class="trading-chart">
                            <div class="chart-container">
                                <div class="chart-header">
                                    <div class="asset-selector">
                                        <select id="asset-select">
                                            <option value="EURUSD">EUR/USD</option>
                                            <option value="GBPUSD">GBP/USD</option>
                                            <option value="USDJPY">USD/JPY</option>
                                            <option value="AUDUSD">AUD/USD</option>
                                            <option value="USDCAD">USD/CAD</option>
                                        </select>
                                    </div>
                                    <div class="timeframe-selector">
                                        <select id="timeframe-select">
                                            <option value="60">1 min</option>
                                            <option value="300">5 min</option>
                                            <option value="900">15 min</option>
                                            <option value="3600">1 hora</option>
                                            <option value="86400">1 dia</option>
                                        </select>
                                    </div>
                                </div>
                                <div id="trading-view-chart" class="trading-view">
                                    <div class="chart-placeholder">
                                        <i class="fas fa-chart-line"></i>
                                        <p>Gráfico será carregado após configuração da API</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="trading-panel">
                            <div class="trade-execution">
                                <h3>Executar Trade</h3>
                                <div class="trade-form">
                                    <div class="form-group">
                                        <label>Ativo</label>
                                        <select id="trade-asset">
                                            <option value="EURUSD">EUR/USD</option>
                                            <option value="GBPUSD">GBP/USD</option>
                                            <option value="USDJPY">USD/JPY</option>
                                            <option value="AUDUSD">AUD/USD</option>
                                            <option value="USDCAD">USD/CAD</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label>Valor da Operação ($)</label>
                                        <input type="number" id="trade-amount" min="1" value="10">
                                    </div>

                                    <div class="trade-direction">
                                        <button class="btn btn-success btn-direction" data-direction="call">
                                            <i class="fas fa-arrow-up"></i> COMPRA
                                        </button>
                                        <button class="btn btn-danger btn-direction" data-direction="put">
                                            <i class="fas fa-arrow-down"></i> VENDA
                                        </button>
                                    </div>

                                    <div class="ai-recommendation" id="ai-recommendation">
                                        <div class="recommendation-header">
                                            <i class="fas fa-robot"></i>
                                            <span>Recomendação da IA</span>
                                        </div>
                                        <div class="recommendation-content">
                                            <span class="recommendation-text" id="ai-recommendation-text">
                                                Configure a API para receber recomendações
                                            </span>
                                            <span class="recommendation-confidence" id="ai-confidence">
                                                Confiança: 0%
                                            </span>
                                        </div>
                                    </div>

                                    <button class="btn btn-primary btn-execute" id="execute-trade" disabled>
                                        Executar Trade
                                    </button>
                                </div>
                            </div>

                            <div class="open-positions">
                                <h3>Posições Abertas</h3>
                                <div class="positions-list" id="positions-list">
                                    <div class="empty-state">
                                        <i class="fas fa-box-open"></i>
                                        <p>Nenhuma posição aberta</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Other sections will be implemented similarly -->
                <section id="analysis-section" class="content-section">
                    <!-- AI Analysis content -->
                </section>

                <section id="history-section" class="content-section">
                    <!-- History content -->
                </section>

                <section id="subscription-section" class="content-section">
                    <!-- Subscription content -->
                </section>

                <section id="settings-section" class="content-section">
                    <!-- Settings content -->
                </section>
            </main>
        </div>
    </div>

    <!-- API Configuration Modal -->
    <div id="api-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Configurar API Deriv</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="api-token">Token da API</label>
                    <input type="password" id="api-token" placeholder="Seu token da API Deriv" required>
                    <p class="help-text">
                        <a href="https://app.deriv.com/account/api-token" target="_blank">
                            Como obter meu token API?
                        </a>
                    </p>
                </div>
                <div class="form-group">
                    <label for="app-id">App ID (Opcional)</label>
                    <input type="text" id="app-id" placeholder="App ID (geralmente não necessário)">
                </div>
                <button id="save-api-btn" class="btn btn-primary btn-full">Salvar Configurações</button>
            </div>
        </div>
    </div>

    <!-- Subscription Modal -->
    <div id="subscription-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Escolher Plano de Assinatura</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="plans-container" id="plans-container">
                    <!-- Plans will be loaded dynamically -->
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <script>
// Solução de emergência - mostrar modal manualmente
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, showing auth modal');
    const authModal = document.getElementById('auth-modal');
    const loadingScreen = document.getElementById('loading-screen');
    
    if (authModal) {
        authModal.style.display = 'block';
        authModal.classList.add('show');
    }
    
    if (loadingScreen) {
        loadingScreen.style.display = 'none';
    }
    
    // Initialize auth manager
    if (typeof window.authManager !== 'undefined') {
        window.authManager.init();
    }
});
</script>
    <script>window.API_BASE = 'http://localhost:5001';</script>
    <script src="js/config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/trading.js"></script>
    <script src="js/subscription.js"></script>
</body>
</html>